<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WebToApp Wizardry Wand | Convert Websites to Apps</title>
    <meta name="description" content="Free tool to convert any website into a PWA app with one click">
    <link rel="icon" type="image/x-icon" href="https://placehold.co/32x32/6366f1/ffffff?text=W">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.134.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.waves.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            500: '#6366f1',
                            600: '#4f46e5',
                        },
                        secondary: {
                            500: '#10b981',
                        }
                    }
                }
            }
        }
    </script>
    <style>
        html {
            scroll-behavior: smooth;
        }
        .vanta-canvas {
            filter: blur(4px);
        }
    </style>
</head>
<body class="bg-gray-50 min-h-screen">
    <div id="vanta-bg" class="fixed inset-0 z-0"></div>
    
    <div class="relative z-10">
        <nav class="bg-white/80 backdrop-blur-md shadow-sm fixed w-full z-30">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex justify-between h-16">
                    <div class="flex items-center">
                        <div class="flex-shrink-0 flex items-center">
                            <i data-feather="zap" class="text-primary-500"></i>
                            <span class="ml-2 font-bold text-xl text-gray-800">WebToApp</span>
                        </div>
                    </div>
                    <div class="hidden md:ml-6 md:flex md:items-center space-x-8">
                        <a href="#" class="text-gray-700 hover:text-primary-500 px-3 py-2 text-sm font-medium">Home</a>
                        <a href="#converter" class="text-gray-700 hover:text-primary-500 px-3 py-2 text-sm font-medium">How It Works</a>
                        <a href="#features" class="text-gray-700 hover:text-primary-500 px-3 py-2 text-sm font-medium">Features</a>
                    </div>
                    <div class="-mr-2 flex items-center md:hidden">
                        <button type="button" class="inline-flex items-center justify-center p-2 rounded-md text-gray-400 hover:text-gray-500 hover:bg-gray-100 focus:outline-none focus:ring-2 focus:ring-inset focus:ring-primary-500" aria-controls="mobile-menu" aria-expanded="false" id="mobile-menu-button">
                            <i data-feather="menu"></i>
                        </button>
                    </div>
                </div>
            </div>
            <div class="hidden md:hidden bg-white/95 backdrop-blur-md" id="mobile-menu">
                <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
                    <a href="#" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-primary-500 hover:bg-gray-50">Home</a>
                    <a href="#converter" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-primary-500 hover:bg-gray-50">How It Works</a>
                    <a href="#features" class="block px-3 py-2 rounded-md text-base font-medium text-gray-700 hover:text-primary-500 hover:bg-gray-50">Features</a>
                </div>
            </div>
        </nav>

        <section class="pt-32 pb-20 px-4 sm:px-6 lg:px-8 max-w-7xl mx-auto">
            <div class="text-center">
                <h1 class="text-4xl font-extrabold tracking-tight text-gray-900 sm:text-5xl md:text-6xl">
                    <span class="block">Turn Any Website Into</span>
                    <span class="block text-primary-500">An Installable App</span>
                </h1>
                <p class="mt-3 max-w-md mx-auto text-base text-gray-500 sm:text-lg md:mt-5 md:text-xl md:max-w-3xl">
                    Our magic wand converts any website URL into a Progressive Web App (PWA) instantly - no coding required!
                </p>
                <div class="mt-10 max-w-md mx-auto sm:max-w-lg sm:flex sm:justify-center">
                        <a href="#converter" class="w-full sm:w-auto inline-flex items-center justify-center px-8 py-4 border border-transparent text-base font-medium rounded-md text-white bg-primary-500 hover:bg-primary-600 transition duration-150 ease-in-out shadow-lg hover:shadow-xl transform hover:scale-105">
                            <i data-feather="zap" class="mr-2"></i>
                            Convert Now
                        </a>
                </div>
            </div>
        </section>

        <section id="converter" class="py-16 px-4 sm:px-6 lg:px-8 max-w-4xl mx-auto bg-white/80 backdrop-blur-lg rounded-2xl shadow-xl mt-10">
            <div class="text-center mb-12">
                <h2 class="text-3xl font-extrabold text-gray-900 sm:text-4xl">
                    <span class="block text-primary-500">Magic Wand</span>
                </h2>
                <p class="mt-4 max-w-2xl text-xl text-gray-500 mx-auto">
                    Paste your website URL below and we'll generate an installable app for you.
                </p>
            </div>
            
            <div class="mt-10 sm:mt-12">
                <div class="max-w-2xl mx-auto">
                    <form id="convert-form" class="space-y-6">
                        <div>
                            <label for="website-url" class="block text-sm font-medium text-gray-700">Website URL</label>
                            <div class="mt-1 relative rounded-md shadow-sm">
                                <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                    <i data-feather="globe" class="h-5 w-5 text-gray-400"></i>
                                </div>
                                <input type="url" name="website-url" id="website-url" required class="focus:ring-primary-500 focus:border-primary-500 block w-full pl-10 pr-12 py-3 border-gray-300 rounded-md" placeholder="https://example.com">
                                <div class="absolute inset-y-0 right-0 flex items-center">
                                    <button type="button" onclick="fetchMetadata()" title="Auto-fill name and icon" class="h-full py-0 pl-2 pr-3 border-transparent bg-transparent text-gray-500 hover:text-gray-700 flex items-center">
                                        <i data-feather="wand" class="h-5 w-5"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 gap-6 sm:grid-cols-2">
                            <div>
                                <label for="app-name" class="block text-sm font-medium text-gray-700">App Name</label>
                                <div class="mt-1">
                                    <input type="text" name="app-name" id="app-name" required class="shadow-sm focus:ring-primary-500 focus:border-primary-500 block w-full py-3 px-4 border border-gray-300 rounded-md" placeholder="My Awesome App">
                                </div>
                            </div>
                            <div>
                                <label for="theme-color" class="block text-sm font-medium text-gray-700">Theme Color</label>
                                <div class="mt-1 flex rounded-md shadow-sm h-12">
                                    <input type="color" name="theme-color" id="theme-color" value="#6366f1" class="p-1 h-full block w-full rounded-md border-gray-300">
                                </div>
                            </div>
                        </div>
                        
                        <div class="grid grid-cols-1 gap-6 sm:grid-cols-2">
                            <div>
                                <label for="icon-url" class="block text-sm font-medium text-gray-700">App Icon URL</label>
                                <div class="mt-1 relative rounded-md shadow-sm">
                                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                                        <i data-feather="image" class="h-5 w-5 text-gray-400"></i>
                                    </div>
                                    <input type="url" name="icon-url" id="icon-url" class="focus:ring-primary-500 focus:border-primary-500 block w-full pl-10 py-3 border-gray-300 rounded-md" placeholder="https://example.com/icon.png">
                                </div>
                            </div>
                            <div class="flex items-end">
                                <div class="w-full">
                                    <label class="block text-sm font-medium text-gray-700">Or Upload Icon</label>
                                    <div class="mt-1 flex items-center">
                                        <div id="icon-preview" class="w-12 h-12 rounded-lg bg-gray-200 flex items-center justify-center overflow-hidden border border-gray-300">
                                            <i data-feather="image" class="text-gray-400"></i>
                                        </div>
                                        <button type="button" onclick="document.getElementById('icon-upload').click()" class="ml-4 inline-flex items-center px-4 py-2 border border-gray-300 shadow-sm text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500">
                                            <i data-feather="upload" class="mr-2 h-4 w-4"></i>
                                            Upload
                                        </button>
                                        <input type="file" id="icon-upload" class="hidden" accept="image/*">
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div class="pt-5">
                            <div class="flex justify-end">
                                <button type="submit" class="ml-3 inline-flex justify-center py-3 px-6 border border-transparent shadow-sm text-base font-medium rounded-md text-white bg-primary-500 hover:bg-primary-600 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 transition duration-150 ease-in-out transform hover:scale-105">
                                    <i data-feather="zap" class="mr-2"></i>
                                    Generate App
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </section>

        <footer class="bg-white/80 backdrop-blur-md mt-20">
            <div class="max-w-7xl mx-auto py-12 px-4 overflow-hidden sm:px-6 lg:px-8">
                <p class="text-center text-base text-gray-500">
                    &copy; 2025 WebToApp Wizard. All rights reserved.
                </p>
            </div>
        </footer>
    </div>

    <script>
        // --- Vanta.js Background ---
        VANTA.WAVES({
            el: "#vanta-bg",
            mouseControls: true,
            touchControls: true,
            gyroControls: false,
            minHeight: 200.00,
            minWidth: 200.00,
            scale: 1.00,
            scaleMobile: 1.00,
            color: 0x6366f1,
            shininess: 35.00,
            waveHeight: 15.00,
            waveSpeed: 0.50,
            zoom: 0.8
        });

        // --- Mobile menu toggle ---
        document.getElementById('mobile-menu-button').addEventListener('click', function() {
            const menu = document.getElementById('mobile-menu');
            menu.classList.toggle('hidden');
        });

        // --- Icon upload preview ---
        document.getElementById('icon-upload').addEventListener('change', function(e) {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(event) {
                    const preview = document.getElementById('icon-preview');
                    preview.innerHTML = `<img src="${event.target.result}" class="w-full h-full object-cover rounded-lg" />`;
                    document.getElementById('icon-url').value = ''; // Clear URL if file is uploaded
                };
                reader.readAsDataURL(file);
            }
        });

        // --- Auto-fill name and icon ---
        function fetchMetadata() {
            const urlInput = document.getElementById('website-url');
            if (!urlInput.value || !urlInput.checkValidity()) {
                alert('Please enter a valid Website URL first.');
                return;
            }
            try {
                const url = new URL(urlInput.value);
                const domain = url.hostname;
                
                const appNameInput = document.getElementById('app-name');
                if (!appNameInput.value) {
                    let name = domain.replace('www.', '').split('.')[0];
                    appNameInput.value = name.charAt(0).toUpperCase() + name.slice(1);
                }
                
                const iconPreview = document.getElementById('icon-preview');
                const faviconUrl = `https://icon.horse/icon/${domain}`;
                iconPreview.innerHTML = `<img src="${faviconUrl}" class="w-full h-full object-contain" />`;
                document.getElementById('icon-url').value = faviconUrl;

            } catch (e) {
                console.error('Invalid URL:', e);
                alert('Could not fetch metadata. Please check the URL.');
            }
        }

        // --- Form Submission Handler (The New Logic) ---
        document.getElementById('convert-form').addEventListener('submit', function(event) {
            event.preventDefault();
            generateApp();
        });

        function generateApp() {
            const websiteUrl = document.getElementById('website-url').value.trim();
            const appName = document.getElementById('app-name').value.trim();
            const themeColor = document.getElementById('theme-color').value;
            const iconUrlInput = document.getElementById('icon-url').value.trim();
            const iconPreviewImg = document.getElementById('icon-preview').querySelector('img');
            
            const params = new URLSearchParams({
                name: appName,
                url: websiteUrl,
                theme: themeColor
            });

            // Check if user uploaded an image
            if (iconPreviewImg && iconPreviewImg.src.startsWith('data:image')) {
                // Store the large image data in session storage instead of the URL
                sessionStorage.setItem('userIconData', iconPreviewImg.src);
                params.append('icon', 'uploaded'); // Send a signal word in the URL
            } else if (iconUrlInput) {
                params.append('icon', iconUrlInput); // Send the icon URL as before
            } else {
                alert("Please provide an App Icon URL or upload an icon.");
                return;
            }

            const installerUrl = `installer.html?${params.toString()}`;
            
            document.body.innerHTML = `<h1 style="text-align: center; margin-top: 40vh; font-family: sans-serif; color: #4f46e5;">Generating your app...</h1>`;
            setTimeout(() => {
                window.location.href = installerUrl;
            }, 1000);
        }

        // --- Initialize Feather Icons ---
        feather.replace();
    </script>
</body>
</html>